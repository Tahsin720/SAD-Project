{% extends 'E_book_library_management_system/base2.html' %}

{% block search_page %}
        <form action="{% url 'search' %}" method="POST">
            <input type="text" name="search" placeholder="Search By Name" required>
            <button style="border-radius: 5px; padding: 3px 5px;" type="submit">search</button>
        </form> 
{% endblock %}

{% block book_page %}
    <h5>Book Page</h5>
    <table id="ptable">
        <thead>
            <tr>
                <th>Image</th>
                <th>isbn</th>
                <th>Name</th>
                <th>Author</th>
                <th>Description</th>
                <th>User Name</th>
                <th>Cost</th>
                <th>Is Donated</th>
                <th>Likes</th>
                <th>Dislikes</th>
                <th>Buttons</th>
                <th>Rating</th>

            </tr>
        </thead>
    <tbody>
        {% if book_page %}
            {% for b_page in book_page %}

                <tr>
                    <td> <img src="{{b_page.image.url}}" width="100" height="100"></td>
                    
                    <td>{{b_page.isbn}}</td>
                    <td>{{b_page.name}}</td>
                    <td>{{b_page.author}}</td>
                    <td>{{b_page.description}}</td>
                    <td>{{b_page.user_name}}</td>
                    <td>{{b_page.cost}}</td>
                    <td>{{b_page.isdonated}}</td>
                    <td>{{b_page.likes}}</td>
                    <td>{{b_page.dislikes}}</td>
                    <td>
                        <form action = "{% url 'Request' %}" method="GET">
                            {% csrf_token %}
                            {% if b_page.user_name != request.user.username %}
                                <input type="hidden" id="isbn" name="isbn" value={{b_page.isbn}}>
                                <input type="hidden" id="uname" name="uname" value={{request.user.username}}>
                                <input class="btn" type="submit" name="add" id="add" value="Request">
                            {% endif %}
                        </form>
                        <form action = "{% url 'cancel Request' %}" method="GET">
                            {% csrf_token %}
                            {% if b_page.user_name != request.user.username %}
                                <input type="hidden" id="isbn" name="isbn" value={{b_page.isbn}}>
                                <input class="btn" type="submit" name="cancel" id="cancel" value="Cancel Request">
                            {% endif %}
                        </form>
                    </td>
                    
                    <td>
                        <form action = "{% url 'likes' %}" method="GET">
                            {% csrf_token %}
                            {% if b_page.user_name != request.user.username %}
                                <input type="hidden" id="isbn" name="isbn" value={{b_page.isbn}}>
                                <input class="btn" type="submit" name="cancel" id="cancel" value="Like">
                            {% endif %}
                        </form>
                        <form action = "{% url 'dislikes' %}" method="GET">
                            {% csrf_token %}
                            {% if b_page.user_name != request.user.username %}
                                <input type="hidden" id="isbn" name="isbn" value={{b_page.isbn}}>
                                <input class="btn" type="submit" name="cancel" id="cancel" value="Dislike">
                            {% endif %}
                        </form>
                    </td>

                </tr>
            {% endfor %}
        {% else %}
            <h1>No data!</h1>
        {% endif %}

    </tbody>
    
{% endblock %}